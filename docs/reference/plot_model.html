<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Summarise and Plot Model Trajectories — plot_model • idmodelr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">idmodelr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/seabbs/idmodelr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Summarise and Plot Model Trajectories</h1>
    </div>

    
    <p>This function uses faceting to plot all trajectories in a data frame. It allows the conveniant
manipulation of several simulations or data. It also allows complex model output to be aggregated.
Additionally if data is present, then an additional plot can be displayed
with data and potentially observations generated. This function is heaviliy
based on <a href='https://github.com/sbfnk/fitR/blob/master/R/plot.r'>plotTraj</a> from
the <a href='https://github.com/sbfnk/fitR'>fitR</a> package written by <a href='http://sbfnk.github.io/'>Sebaustian Funk</a>.</p>
    

    <pre class="usage"><span class='fu'>plot_model</span>(<span class='kw'>traj</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>state.names</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>time.column</span> <span class='kw'>=</span> <span class='st'>"time"</span>, <span class='kw'>lines.data</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>summary</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>replicate.column</span> <span class='kw'>=</span> <span class='st'>"replicate"</span>, <span class='kw'>non.extinct</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>plot</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>colour</span> <span class='kw'>=</span> <span class='st'>"firebrick2"</span>, <span class='kw'>set_theme</span> <span class='kw'>=</span> <span class='no'>theme_minimal</span>,
  <span class='kw'>init.date</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>same</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>aggregate_to</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>compartments</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>strat</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>hold_out_var</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>new_var</span> <span class='kw'>=</span> <span class='st'>"incidence"</span>, <span class='kw'>id_col</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>groups</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>total_pop</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>summary_var</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>traj</th>
      <td><p>Data frame, generic model output although tailored
to work with <a href='https://www.rdocumentation.org/packages/pomp/versions/1.4.1.1/topics/pomp'>pomp</a> model objects.</p></td>
    </tr>
    <tr>
      <th>state.names</th>
      <td><p>A character vector. Names of the state variables to plot.
If <code>NULL</code> (default) all state variables are plotted.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A data frame. Observation times and observed data. The time column must match that used in the model object, whilt
the observation name should also match one of those found in the model object.</p></td>
    </tr>
    <tr>
      <th>time.column</th>
      <td><p>A character vector. The column in the data that indicates time</p></td>
    </tr>
    <tr>
      <th>lines.data</th>
      <td><p>Logical. If <code>TRUE</code>, the data will be plotted as lines.</p></td>
    </tr>
    <tr>
      <th>summary</th>
      <td><p>Logical. If <code>TRUE</code>, the mean, median as well as the 50th and 95th percentile
of the trajectories are plotted (default). If <code>FALSE</code>, all individual trajectories are plotted.</p></td>
    </tr>
    <tr>
      <th>replicate.column</th>
      <td><p>A character vector. The column in the data that indicates the replicate
(if muliple replicates are to be plotted, i.e. if <code>summary</code> is <code>FALSE</code></p></td>
    </tr>
    <tr>
      <th>non.extinct</th>
      <td><p>A character vector. Names of the infected states which must be non-zero so the epidemic is still ongoing.
When the names of these states are provided, the extinction probability is plotted by computing the proportion of faded-out
epidemics over time. An epidemic has faded-out when all the infected states (whose names are provided) are equal to 0.
This is only relevant for stochastic models.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Transparency of the trajectories (between 0 and 1).</p></td>
    </tr>
    <tr>
      <th>plot</th>
      <td><p>if <code>TRUE</code> the plot is displayed, and returned otherwise.</p></td>
    </tr>
    <tr>
      <th>colour</th>
      <td><p>A character vector. If a character, will use that colour to plot trajectories. If "all", use all available colours.
If <code>NULL</code>, don't set the colour.</p></td>
    </tr>
    <tr>
      <th>set_theme</th>
      <td><p>Set the ggplot2 theme, defaults to theme_minimal.</p></td>
    </tr>
    <tr>
      <th>init.date</th>
      <td><p>Character. Date of the first point of the time series (default to <code>NULL</code>). If provided, the x-axis will be
in calendar format. NB: currently only works if the unit of time is the day.</p></td>
    </tr>
    <tr>
      <th>same</th>
      <td><p>Logical. If <code>TRUE</code> does not facet plots.</p></td>
    </tr>
    <tr>
      <th>aggregate_to</th>
      <td><p>A character vector or list specifying the aggregation operations to perform on the
model output. Operations are carried out in the order specified. Implemented options are; disease, demographic,
and incidence.</p></td>
    </tr>
    <tr>
      <th>compartments</th>
      <td><p>A character vector or list specifying the unique compartments to aggregate. May either be
specified once for all aggregation functions or for each function seperately.</p></td>
    </tr>
    <tr>
      <th>strat</th>
      <td><p>The number of stratified groups in the model.</p></td>
    </tr>
    <tr>
      <th>hold_out_var</th>
      <td><p>A character vector or list specifying the unique compartments that will not be aggregated. May either be
specified once for all aggregation functions or for each function seperately. If compartments is set then this arguement does
not need to be used.</p></td>
    </tr>
    <tr>
      <th>new_var</th>
      <td><p>A character vector specifying the new variable to add when aggregating incidence.</p></td>
    </tr>
    <tr>
      <th>id_col</th>
      <td><p>A character string containing the name of the new id column.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>A character vector with length equal to the level of stratification. Used to name the stratified levels.</p></td>
    </tr>
    <tr>
      <th>total_pop</th>
      <td><p>A logical (defaults to <code>TRUE</code>) indicating if the total population should be
calculated when summarsing the model demographics.</p></td>
    </tr>
    <tr>
      <th>summary_var</th>
      <td><p>A logical (defaults to <code>FALSE</code>), specifiying whether to add an additional summary variable across
all stratified levels.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Logical (defaults to <code>FALSE</code>), indicates if internal process messages should be printed</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Optionally prints or stores a plot of trajectories</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p>summarise_model aggregate_model</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Intialise</span>
<span class='no'>N</span> <span class='kw'>=</span> <span class='fl'>100000</span>
<span class='no'>I_0</span> <span class='kw'>=</span> <span class='fl'>1</span>
<span class='no'>S_0</span> <span class='kw'>=</span> <span class='no'>N</span> - <span class='no'>I_0</span>
<span class='no'>R_0</span> <span class='kw'>=</span> <span class='fl'>1.1</span>
<span class='no'>beta</span> <span class='kw'>=</span> <span class='no'>R_0</span>

<span class='co'>##Time for model to run over</span>
<span class='no'>tbegin</span> <span class='kw'>=</span> <span class='fl'>0</span>
<span class='no'>tend</span> <span class='kw'>=</span> <span class='fl'>50</span>
<span class='no'>times</span> <span class='kw'>&lt;-</span> <span class='fu'>seq</span>(<span class='no'>tbegin</span>, <span class='no'>tend</span>, <span class='fl'>1</span>)

<span class='co'>##Vectorise input</span>
<span class='no'>parameters</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='kw'>beta</span> <span class='kw'>=</span> <span class='no'>beta</span>)
<span class='no'>inits</span> <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='kw'>S</span> <span class='kw'>=</span> <span class='no'>S_0</span>, <span class='kw'>I</span> <span class='kw'>=</span> <span class='no'>I_0</span>)

<span class='no'>SI_sim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='simulate_model.html'>simulate_model</a></span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>SI_ode</span>, <span class='kw'>sim_fn</span> <span class='kw'>=</span> <span class='no'>solve_ode</span>, <span class='no'>inits</span>, <span class='no'>parameters</span>, <span class='no'>times</span>)

<span class='fu'>plot_model</span>(<span class='no'>SI_sim</span>)</div><img src='plot_model-2.png' alt='' width='540' height='400' /><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Sam Abbott.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
